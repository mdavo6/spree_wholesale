c
variant.stock_items.count_on_hand
variant.stock_items
variant.stock_items.count_on_hand
variant.count_on_hand
variant.stock_items

variant
variant.in_stock?
variant.in_stock
variant
Spree::Variant.in_stock.size
Spree::Variant.in_stock
order.line_items.size
order.line_items
expect(order.line_items.size).to eq(Spree::Variant.in_stock.size)
order = wholesale_user.orders.last
expect(response).to redirect_to spree.cart_path
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
expect(response).to redirect_to spree.cart_path
c
Spree::Variant
c
order = wholesale_user.orders.last
expect(response).to redirect_to spree.cart_path
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
stock_item
variant
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
wholesale_user.orders.count
wholesale_user.orders
wholesale_user
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
stock_item.save!
variant
stock_item
c
variant
stock_item
c
stock_item
c
stock_item
allow(controller).to receive(:try_spree_current_user) {wholesale_user}
c
Spree::Variant = variant
variant
c
wholesale_user.orders.count
order
line_item = order.line_items
line_item = order.line_items.first
expect(order.line_items.size).to eq(Spree::Variant.in_stock.size)
order = wholesale_user.orders.last
expect(response).to redirect_to spree.cart_path
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
Spree::User
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
expect { spree_post :wholesale }.to change { wholesale_user.orders.count }.by(1)
c
expect do
c
n
spree_post :wholesale
